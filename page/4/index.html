
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>向向的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="向向">
    

    
    <meta name="description" content="This is my blog...">
<meta property="og:type" content="website">
<meta property="og:title" content="向向的博客">
<meta property="og:url" content="https:&#x2F;&#x2F;sunnie-shine.github.io&#x2F;page&#x2F;4&#x2F;index.html">
<meta property="og:site_name" content="向向的博客">
<meta property="og:description" content="This is my blog...">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="向向的博客" title="向向的博客"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="向向的博客">向向的博客</a></h1>
				<h2 class="blog-motto">Console.WriteLine(&#34;Hello, ^_^&#34;);</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">全部文档</a></li>
					
						<li><a href="/categories">分类</a></li>
					
						<li><a href="/tags">标签</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:Sunnie-Shine.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/22/clang-11-matrix-array/" title="C 语言语法系列（11）：二维数组" itemprop="url">C 语言语法系列（11）：二维数组</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-22T06:57:39.000Z" itemprop="datePublished"> 发表于 2019-11-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>前文我们讲到了一维数组的基本赋值方式和使用方式，但基本上我们可以看到，如果不是迫不得已的情况下，貌似一维数组已经够用了，不过为了教程的完整性，我们还是把一些其它情况，必须要更高维的数组的时候，它们的语法格式讲一下。今天说的是二维数组。</p>
<h2 id="二维数组的定义"><a href="#二维数组的定义" class="headerlink" title="二维数组的定义"></a>二维数组的定义</h2><p>当我们在人为定义的情况下必须要使用两个维度（行和列）的时候，就不得不使用二维数组来定义，比如一个表格。比如，我们需要一个 3 行 4 列的表格，它的定义方式是这样的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> table[<span class="number">3</span>][<span class="number">4</span>];</span><br></pre></td></tr></table></figure>
<p>此时，我们需要在定义语句里写上两个中括号，一个表示行，一个表示列。这个地方的定义就表示一个二维数组是 3 行 4 列的。同时请你继续注意的地方是，这里的中括号是定义语句里用的，所以它表示这个数组是多少行多少列的，而并非取出第 3 行第 4 列的数据。请你注意这一点。</p>
<blockquote>
<p>你也可以理解为，<code>table</code> 变量一共有三个元素构成，每一个元素都是一个需要 4 个元素的数组构成的一维数组序列。所以这种理解方式更类似于“是一个一维数组，只是每一个数据的类型是一个一维数组，即数组的数组”。</p>
</blockquote>
<h2 id="初始化赋值"><a href="#初始化赋值" class="headerlink" title="初始化赋值"></a>初始化赋值</h2><p>在二维数组里，初始化赋值就比较麻烦了。比如，一种简单的赋值方式是采取“数组的数组”的理解方式来赋值的，比如这样：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> table[<span class="number">3</span>][<span class="number">4</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span> &#125;,</span><br><span class="line">    &#123; <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span> &#125;,</span><br><span class="line">    &#123; <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>即存放了三个元素，且每一个元素都是一个<strong>存四个 <code>int</code> 类型元素的一维数组</strong>的二维数组。和前文一样，二维数组当完整赋值后，可以不写出元素个数。但在二维数组里，只能省略行元素总数 3，而不可以省略列元素的总个数 4，即：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> table[][<span class="number">4</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span> &#125;,</span><br><span class="line">    &#123; <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span> &#125;,</span><br><span class="line">    &#123; <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>注意，这种设计是为了保证后续可以完整取出具体位置的元素而设计的。</p>
<blockquote>
<p>数组在内存里的表达实际上都是一个一维数组。显然，内存是一个长条分布的形状，所以不管多少维度的数组，哪怕后面用到的更高维度的数组，在内存里都只可能表示成一个一维的数组形式，而一个二维数组需要列元素的个数这一个信息来正确分割整个数组，来保证二维数组的成立。如果你省略了列元素的个数，我们就无法在正确的地方断开这个数组，进而得不到正确结果。比如，一个数组拥有 12 个元素（3 行 4 列），那么它在内存里只能表示成这样：</p>
<p><img src="2d-array.png" alt=""></p>
<p>这个表达形式可以看到，我们为一个一维数组进行正确的定界是必须要<strong>列元素数</strong>这个信息的。所以列元素总数这个数字是不可以省略的。</p>
</blockquote>
<p>另外，二维数组也可以省略一些元素的赋值，此时将会默认赋值 0：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> table[][<span class="number">4</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    &#123; <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="number">2</span>, <span class="number">3</span> &#125;,</span><br><span class="line">    &#123; <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这样的话，整个数组的赋值的情况就是</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>第 0 列</th>
<th>第 1 列</th>
<th>第 2 列</th>
<th>第 3 列</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>第 0 行</strong></td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><strong>第 1 行</strong></td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><strong>第 2 行</strong></td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
</tbody>
</table>
</div>
<p>当然，内部的大括号都可以被省略，但这个时候就不能省略中间的元素了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> table[][<span class="number">4</span>] = &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>和上面的逻辑一样，这个赋值方式依然是满足要求的，这样就可以看出赋值语句里<strong>列元素数</strong>这个信息的重要性了。</p>
<p>当然，它也可以不完全赋值：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> table[][<span class="number">4</span>] = &#123; <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>那么，从第十个元素开始（从 0 开始算就是第 9 号元素）都被赋值为 0。</p>
<h2 id="二维数组存取数值"><a href="#二维数组存取数值" class="headerlink" title="二维数组存取数值"></a>二维数组存取数值</h2><p>按照 C 语言的规定，数组的索引从 0 开始（所谓的索引，就是取值和存值的那个中括号里的数值，它可以表示这个数组的第几个元素，这个数就是<strong>索引</strong>，有时候也称为<strong>下标</strong>，Index），所以二维数组的两个维度都是从 0 开始。</p>
<p>不过，二维数组需要两个索引，一个行索引，一个列索引：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> table[][<span class="number">4</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    &#123; <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="number">2</span>, <span class="number">3</span> &#125;,</span><br><span class="line">    &#123; <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>那么，要取出第 10 个元素 5，应如何写呢？</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> value = table[<span class="number">2</span>][<span class="number">1</span>];</span><br></pre></td></tr></table></figure>
<p>即第 2 行第 1 列的元素（注意，这个索引数值是从 0 开始，所以第 2 行就是我们人为理解的第三行，而第 1 列就是我们理解的第二列），第三行第二列就是 5 了。</p>
<p>另外，初始化赋值可以这么写：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        table[i][j] = i * <span class="number">4</span> + j + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样，整个数组的元素就被赋值为从 1 到 12 了，依然请你注意 <code>for</code> 循环的条件 <code>i &lt; 3</code> 和 <code>j &lt; 4</code>。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C/">C</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/">C.语法</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/C-%E8%AF%AD%E6%B3%95-%E6%95%99%E7%A8%8B/">C.语法.教程</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>



   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/22/clang-10-linear-array/" title="C 语言语法系列（10）：一维数组" itemprop="url">C 语言语法系列（10）：一维数组</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-22T06:46:35.000Z" itemprop="datePublished"> 发表于 2019-11-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="数组是什么？"><a href="#数组是什么？" class="headerlink" title="数组是什么？"></a>数组是什么？</h2><p>在前文的知识点里，我们描述了很多有关重复性的内容，例如 C 语言提供的三大循环语句：<code>while</code>、<code>do-while</code> 和 <code>for</code> 循环，还谈论了 <code>for</code> 的各种“奇葩”用法。今天要讲的重复性内容，并非针对执行操作，而是针对于数值存储。</p>
<p>试想一下，如果我们需要大量信息，而且它们需要的内容的类型近乎一致。比如我们要存储 50 个学生的数学成绩，如果我们单纯使用 50 个变量的话，显然是不好读也不好取。那么，有没有办法解决呢？有，这便是我们今天要说到的新的知识点：<strong>数组</strong>（Array）。</p>
<h2 id="数组的定义"><a href="#数组的定义" class="headerlink" title="数组的定义"></a>数组的定义</h2><p>数组有<strong>类型</strong>（Type）一说，有<strong>维度</strong>（Rank）一说，也有<strong>长度</strong>（Length）一说，这是在初始定义的时候为其决定的，这类似于变量的定义。语法约定是这样的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">50</span>];</span><br></pre></td></tr></table></figure>
<p>这样便定义了一个数组（有时候也把数组直接叫做数组变量），这个数组一共存放 50 个元素，且全部都是 <code>int</code> 类型的元素。</p>
<p>数组一共具有三大属性：类型、维度和长度，那么针对于这个数组变量而言，它的类型是 <code>int</code>，维度是一维的，而长度是 50（即总元素个数）。所谓的维度，就是数组整体呈现几个维度的形式。我们今天讲的内容都是一维数组，即只有一个维度。</p>
<h2 id="数组的赋值"><a href="#数组的赋值" class="headerlink" title="数组的赋值"></a>数组的赋值</h2><p>数组赋值有两种操作，一种是自定义数据，在初始化的方式赋值，还有一种是后续赋值，后续赋值就需要借助循环语句来实现，因为它是采用的逐个元素的赋值的逻辑。</p>
<h3 id="初始化赋值"><a href="#初始化赋值" class="headerlink" title="初始化赋值"></a>初始化赋值</h3><p>初始化赋值方式是在定义语句上直接使用赋值符号 <code>=</code> 和一个大括号表示的集合序列来赋值的。</p>
<blockquote>
<p>下面为了简化赋值，这里把 50 个元素更改为 10 个元素的数组，进行赋值。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">10</span>] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">256</span>, <span class="number">512</span>, <span class="number">1024</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>这样的赋值操作是逐个对应的。这个 <code>scores</code> 数组的第一个元素数值是 1，第二个元素是 2，第三个是 4，第四个是 8，以此类推。</p>
<p>如果你赋值的数值过多，编译器层面就会报错，提示你不遵循语法规则，exe 的文件都不会让你成功生成。</p>
<p>不过，元素如果不够 10 个的话，赋值是成功的，也是不会出错的，但是剩余的元素都会被默认赋值为 0。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">10</span>] = &#123; <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">12</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>这表示 <code>scores</code> 数组里最后 6 个元素全部为 0。</p>
<p>但请注意。如果初始化不给出大括号的赋值语句，这个数组就是空的，即没有赋值的状态。如果在没有初始化的情况就在使用这个数组的话，就会容易出现程序崩溃的错误。所以请尽量避免这个操作。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">10</span>]; <span class="comment">// Non-assigned state.</span></span><br></pre></td></tr></table></figure>
<p>如果你想把数组全部赋值为 0，可以采用下面两种方式赋值：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(scores, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>) * <span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<p>这是第一种赋值方式，小括号第一个部分写上数组名称，第二个部分写上赋值的初始值（这里是 0，其它数值需要非常复杂的转换得到，这里不作出讲解），第三个部分写上数组整体占的内存大小。</p>
<p>第二种是用大括号这种熟悉的方式赋值，只需要在大括号里写一个元素 0 即可。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>这样就可以了，因为其它没有赋值的部分都会默认赋值为 0，而此时给了第一个元素也赋值为 0，所以相当于就是全部为 0 了。</p>
<blockquote>
<p>在明确赋值元素足够的时候，中括号里的数值可以不写。比如</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">256</span>, <span class="number">512</span>, <span class="number">1024</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>就等价于</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">10</span>] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">64</span>, <span class="number">128</span>, <span class="number">256</span>, <span class="number">512</span>, <span class="number">1024</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>中括号里的数值，就等于后面大括号里元素的总个数 10 个。</p>
</blockquote>
<h3 id="后续赋值"><a href="#后续赋值" class="headerlink" title="后续赋值"></a>后续赋值</h3><p>你也可以借用循环语句赋值，但需要讲解存取数组的元素的语法才可以。现在我们来说一下，如何取出数组里的元素，和修改这些元素的值。</p>
<h3 id="数组初始化的长度是否可以用变量表示？"><a href="#数组初始化的长度是否可以用变量表示？" class="headerlink" title="数组初始化的长度是否可以用变量表示？"></a>数组初始化的长度是否可以用变量表示？</h3><p>思考一个问题。我们是否可以用一个变量来表示数组的长度呢？</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;i);</span><br><span class="line"><span class="keyword">int</span> arr[i]; <span class="comment">// Does it work?</span></span><br></pre></td></tr></table></figure>
<p>这么书写，是否表示输入的数值是多少，数组初始化的时候长度就是多少呢？</p>
<p>在 C99 标准之前，这种写法一直都是不被允许的。在考试过程时，一般也不允许这种写法，不过 C99 标准开始允许你这么声明数组，即<strong>可变长数组</strong>（Variable Length Array，简称 <strong>VLA</strong>）。VLA 这种特性是在 C99 标准才引入的，所以如果你需要使用 VLA，考试里则是肯定不允许的。</p>
<h2 id="数组内元素的存取"><a href="#数组内元素的存取" class="headerlink" title="数组内元素的存取"></a>数组内元素的存取</h2><p>前文讲述了如何使用数组进行定义和初始化，它采用的是中括号的方式，写在数组名称的后面，中括号里写上总元素个数来表达。</p>
<p>在存取元素的时候，我们依旧用的是中括号，而且稍微在使用上和初始化里的中括号有一点区别：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">10</span>] = &#123; <span class="number">82</span>, <span class="number">100</span>, <span class="number">96</span>, <span class="number">57</span>, <span class="number">14</span>, <span class="number">99</span>, <span class="number">90</span>, <span class="number">60</span>, <span class="number">68</span>, <span class="number">77</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>我们要取出上述第三个元素的话，请使用 <code>[第几个元素 - 1]</code> 的方式来取值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> thirdOne = scores[<span class="number">2</span>]; <span class="comment">// thirdOne is assigned 96</span></span><br></pre></td></tr></table></figure>
<p>在 C 语言里，取值是从 0 开始的，并非 1 开始，所以需要你注意数组取值的时候，中括号里写的数值是多少。比如取出第三个元素，则写的是 <code>array[2]</code>，而非 <code>array[3]</code>。</p>
<p>那么，整体使用的格式是这样的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> scores[] = &#123; <span class="number">82</span>, <span class="number">100</span>, <span class="number">96</span>, <span class="number">57</span>, <span class="number">14</span>, <span class="number">99</span>, <span class="number">90</span>, <span class="number">60</span>, <span class="number">68</span>, <span class="number">77</span> &#125;;</span><br><span class="line">    <span class="keyword">int</span> thirdOne = scores[<span class="number">2</span>]; <span class="comment">// thirdOne is assigned 96</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, thirdOne);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个程序将会输出 96。</p>
<p>下面就可以说下后续赋值的方式了。</p>
<p>由于我们学习了循环语句，所以我们可以采用方便 <code>for</code> 循环为其赋值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> arr[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    arr[i] = i + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>请注意，数组赋值用到了 <code>for</code> 循环，而我们之前说过，取值的中括号里写的数字是从 0 开始算的，所以最大的元素值是 9（因为 0 到 9 一共是 10 个元素了），所以初始化赋值的时候 <code>i = 0</code> 而不是 <code>i = 1</code>，因为这个 <code>i</code> 就是表示这个中括号里的数值的；而条件写的是 <code>i &lt; 10</code> 而不是 <code>i &lt;= 10</code>。</p>
<p>而上述逻辑里的 <code>arr[i]</code> 就表示 <code>arr</code> 数组的第 <code>i + 1</code> 个元素。比如 <code>i</code> 是 6，则 <code>arr[i]</code> 就表示的是第七个元素，因为从 0 开始计算。而最终执行完毕这个 <code>for</code> 后，整个数组的数值就是 1、2、3、4、5、6、7、8、9、10 了。</p>
<p>当然，你还可以为其进行手动赋值：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">arr[<span class="number">6</span>] = <span class="number">8</span>;</span><br><span class="line">arr[<span class="number">9</span>] = <span class="number">14</span>;</span><br></pre></td></tr></table></figure>
<p>这样就可以为这个数组的第 2、7、10 个元素赋值 3、8 和 14，而其余元素的数值都会被默认初始化为 0。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C/">C</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/">C.语法</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/C-%E8%AF%AD%E6%B3%95-%E6%95%99%E7%A8%8B/">C.语法.教程</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>



   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/22/clang-09-jumping-clause/" title="C 语言语法系列（9）：跳转语句" itemprop="url">C 语言语法系列（9）：跳转语句</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-22T05:44:57.000Z" itemprop="datePublished"> 发表于 2019-11-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>还记得前文学到的质数判断和嵌套循环吗？前文遇到了一个例子，我们尝试跳出循环，但发现知识不足以让我们在期间跳出循环的执行，所以我们在那个时候无能为力，好在这个思路并不会使得代码的逻辑变成错的，它仅仅涉及到代码执行的优化。</p>
<p>今天的内容，我们将会处理这些特殊的处理。我们一共要学习三种语句模式：“<code>break</code> 语句”、“<code>continue</code> 语句”和“标签 + <code>goto</code> 语句”模型。</p>
<h2 id="break-语句：跳出循环"><a href="#break-语句：跳出循环" class="headerlink" title="break 语句：跳出循环"></a><code>break</code> 语句：跳出循环</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (n &lt;= digit - <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    remainder = digit % n;</span><br><span class="line">    <span class="keyword">if</span> (remainder == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// This is not a prime number.</span></span><br><span class="line">        isPrime = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// Jump out of the loop.</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    n++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>我们省略了一些代码，只关注于循环语句，和 <code>break</code> 语句。<code>break</code> 语句是单独有分号结尾的，否则它将只是一个关键字。</p>
<p>在执行循环的时候，如果发现它已经不是质数了，就没必要再往下执行后面的判断是否除尽的逻辑了，于是在这里就跳出循环，所以写在应当跳出循环的位置上。</p>
<blockquote>
<p>很多小伙伴在初学这个语句的时候，以为它可以跳出 <code>if</code> 条件。请注意，<code>break</code> 语句是只跟包含它的这层循环有关，它仅能跳出一层循环。也就是说，如果有两个 <code>while</code> 循环，如果把 <code>break</code> 语句写在最里面，那么它也只能跳出最内层的循环，而靠外的这一层循环依旧会继续往下执行，比如原本的例子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (digit = <span class="number">2</span>; digit &lt;= <span class="number">100</span>; digit++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">2</span>, isPrime = <span class="number">1</span>; n &lt;= digit - <span class="number">1</span>; n++)</span><br><span class="line">    &#123;</span><br><span class="line">        remainder = digit % n;</span><br><span class="line">        <span class="keyword">if</span> (remainder == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// This is not a prime number.</span></span><br><span class="line">            isPrime = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// Here break the inner loop.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Break clause will lead the execution to jump to here.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (isPrime)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, digit);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个 <code>break</code> 语句只能让语句跳转到第 14 行继续执行，所以下方的 <code>isPrime</code> 的判断条件它照样要走。所以这么考虑起来，这个 <code>break</code> 语句的跳转逻辑是没有问题的。</p>
</blockquote>
<h2 id="continue-语句：执行下一次循环"><a href="#continue-语句：执行下一次循环" class="headerlink" title="continue 语句：执行下一次循环"></a><code>continue</code> 语句：执行下一次循环</h2><p>要说 <code>break</code> 语句是跳出循环，那么和它写法类似的 <code>continue</code> 语句就不是这个行为了。<code>continue</code> 语句直接终结当前这一次循环的执行逻辑，直接跳转到循环的开头去判断条件（而 <code>for</code> 循环则跳转到增量处）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= <span class="number">10</span>; n++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">3</span> == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d "</span>, n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述示例给出了一个从 1 到 10 的循环。当循环执行的过程中发现 n 本身被 3 整除，就会自动跳转到 <code>n++</code> 增量语句处执行，而不会遇到 <code>printf(&quot;%d &quot;, n);</code> 语句。这个示例展示了如何输出不是 3 的整倍数的代码。</p>
<p>它和 <code>break</code> 语句不一样的地方在于，<code>continue</code> 不会退出代码，而是跳转到增量（<code>for</code> 循环）或条件（<code>while</code> 或 <code>do-while</code> 循环）处执行。</p>
<h2 id="goto-语句：跳转到任意的执行位置"><a href="#goto-语句：跳转到任意的执行位置" class="headerlink" title="goto 语句：跳转到任意的执行位置"></a><code>goto</code> 语句：跳转到任意的执行位置</h2><h3 id="用-goto-代替循环"><a href="#用-goto-代替循环" class="headerlink" title="用 goto 代替循环"></a>用 <code>goto</code> 代替循环</h3><p>最为灵活的语句非 <code>goto</code> 语句莫属，它可以跳转到程序的任意你想要到达的位置上去（当然，在 <code>main</code> 函数外面去是不可以的）。</p>
<p>考虑如下行为。如果我们没有循环的时候，我们可以尝试使用 <code>goto</code> 来达到循环的目的。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>, sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">Loop:</span><br><span class="line"><span class="keyword">if</span> (i &lt;= <span class="number">100</span>)</span><br><span class="line">&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">goto</span> Loop; <span class="comment">// Return to the label `Loop`.</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述示例将会输出从 1 到 100 内的数字的和。当执行到条件满足时，将会自动统计结果，并跳转到 <code>Loop</code> 标签处（第 3 行）继续执行代码。直到条件不成立的时候，到 <code>else</code> 部分，输出结果，此时没有 <code>goto</code> 语句，所以会继续往下执行，而不会再返回上面了。</p>
<p>请注意，标签名称的定义依然满足标识符的命名规则（数字、字母、下划线的那些规矩），所以不要乱取名。而且，标签不能位于函数的外面。比如下面的这个示例，就会出现错误：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">Test:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">goto</span> Test;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"goto\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码是会报错的，不是运行的时候出错，而是直接在运行和编译程序之前就会出现错误。</p>
<h3 id="你叫它标签？"><a href="#你叫它标签？" class="headerlink" title="你叫它标签？"></a>你叫它标签？</h3><p>是的，在前文里，使用标识符规则加一个冒号的部分我们称为<strong>标签</strong>（Label）。标签并非任何执行语句，它没有意义，跟注释差不多。但和注释的区别在于，注释在运行的 exe 里不会出现，而标签你可能还会查到这个东西存在的影子。</p>
<p>标签可以控制程序运行的顺序和行为，比如上面正确的那一则例子，它可以控制语句形成一个循环，来达到模拟循环的效果。而且，在前文介绍的 <code>switch</code> 语句也大量使用到了标签。仔细回忆一下，<code>switch</code> 语句配合 <code>case</code> 语句使用，而 <code>case</code> 语句末尾就是用的冒号。是的，<code>case</code> 语句就是一个特殊的标签，它用于规定 <code>switch</code> 小括号里的表达式的结果的分情况处理行为。当都不成立的时候，语句将会跳转到 <code>default</code> 标签处执行。</p>
<p>但可以发现，它并不影响程序的真正运行规范（比如大括号并不会因为标签的行为而断开和分割开），所以请注意，像是 <code>switch</code> 语句或是上面的这样的例子里，我们不能在同一个范围里定义两个名字完全一样的变量。比如说</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>, sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">Loop:</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">3</span>; <span class="comment">// Wrong here.</span></span><br><span class="line"><span class="keyword">if</span> (i &lt;= <span class="number">100</span>)</span><br><span class="line">&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">goto</span> Loop;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">switch</span> (a)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        c = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        c = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">2</span>; <span class="comment">// Wrong here.</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        c = <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">3</span>; <span class="comment">// Also wrong here.</span></span><br><span class="line">        c = <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        c = <span class="number">16</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>两个例子里，变量在错误的代码处是完全可以看到第一行给出的变量的，所以在可以看到的地方重新定义这些变量是有语义冲突的。</p>
<blockquote>
<p>不过，C 语言允许第 2 种情况的代码，意味着这个代码不会出错，但错误很隐蔽：在 <code>case 3</code> 和 <code>case 5</code> 标签处各定义了一个 <code>i</code> 变量，而这两处的 <code>i</code> 和第 1 行定义的 <code>i</code> 并不是同一个变量，而是两个完全没有关系的变量，只是恰好这里同名了。</p>
<p>我们应尽量避免这种定义行为。</p>
</blockquote>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C/">C</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/">C.语法</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/C-%E8%AF%AD%E6%B3%95-%E6%95%99%E7%A8%8B/">C.语法.教程</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>



   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/22/clang-08-nested-loop/" title="C 语言语法系列（8）：嵌套的循环" itemprop="url">C 语言语法系列（8）：嵌套的循环</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-22T04:43:34.000Z" itemprop="datePublished"> 发表于 2019-11-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="嵌套？"><a href="#嵌套？" class="headerlink" title="嵌套？"></a>嵌套？</h2><p>什么是<strong>嵌套</strong>（Nest）？嵌套是 C 语言和其它众多编程语言里的一个重要的语法术语，它表示执行的控制流语句（<code>if</code>、<code>switch</code>、<code>while</code>、<code>do-while</code> 和 <code>for</code> 语句统称控制流语句，它们控制着整个程序的执行流程：是条件判断来走不同分支，还是反复执行相同的执行语句）的内部继续使用这些控制流语句的写法。比如前文介绍的 <code>if</code> 内还有 <code>if</code> 的情况：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">int</span> j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (i == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">    j = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        j = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        j = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>比如这个写法格式里的 <code>j</code> 的结果是 3，它先走了 <code>i == 2</code> 这个 <code>if</code> 条件的 <code>else</code> 部分，然后发现它也不满足 <code>i &lt; 2</code> 的情况，所以它最终走了 <code>i &lt; 2</code> 这个 <code>if</code> 条件里的 <code>else</code> 部分，获得了 <code>j = 3</code> 的赋值。</p>
<p>很有意思的是，循环也是可以嵌套使用的。正因为如此，循环和条件判断的各种语句才会产生各种不同的组合模式，产生不同的代码书写技巧，比如<strong>枚举法</strong>（Enumeration）。不过，我们先要介绍，代码到底是怎么运算执行嵌套循环的。</p>
<h2 id="实例：质数的判断"><a href="#实例：质数的判断" class="headerlink" title="实例：质数的判断"></a>实例：质数的判断</h2><p>最好理解的、最基础的例子就是求质数了。</p>
<p>质数的定义是，在把一个大于等于 2 的整数分解为多个正整数的乘积时，如果只能分解为 <code>1 × 自己</code> 的话，这个数就是<strong>质数</strong>（也称<strong>素数</strong>，Prime），一般常见的质数有 2、3、5、7、11、13、17、19 等。</p>
<p>现在我们尝试输出所有 100 以内的所有质数。我们的代码怎么写呢？</p>
<h3 id="先实现判别质数的功能"><a href="#先实现判别质数的功能" class="headerlink" title="先实现判别质数的功能"></a>先实现判别质数的功能</h3><p>首先，我们尝试用爆破的方式，对一个整数尝试进行挨个数字的试除。如果这个整数无法被整除掉，说明它只能被 1 整除掉，故这个数肯定就是质数了。比如，我们要计算 17 是否是质数（即使我们背了表，知道它是质数），逻辑大致就是从 2 开始，一直计算到 16（17 除以 17 显然等于 1，所以这个除法已经没有意义了，所以我们只要求计算到 16 即可），让 17 挨个去除以这个数，如果每一次除法得到的结果都不能被整除，说明这个数肯定就是质数了）：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> digit = <span class="number">17</span>, n = <span class="number">2</span>, remainder;</span><br><span class="line"><span class="keyword">int</span> isPrime = <span class="number">1</span>; <span class="comment">// 1 means `digit` is a prime, 0 means not.</span></span><br><span class="line"><span class="keyword">while</span> (n &lt;= digit - <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    remainder = digit % n;</span><br><span class="line">    <span class="keyword">if</span> (remainder == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// This is not a prime number.</span></span><br><span class="line">        isPrime = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    n++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (isPrime) <span class="comment">// Equi to condition `isPrime != 0`</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d is a prime.\n"</span>, digit);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d is not a prime.\n"</span>, digit);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们来大致看下逻辑。首先，我们为需要用到的条件进行变量的声明（定义），然后设置一个结果量 <code>isPrime</code>，来表示它是否是质数（1 表示这个数是质数，0 表示这个数不是质数）。</p>
<p>然后考虑 <code>while</code> 循环里的内容。我们肯定要让 <code>n</code> 从 2 计算到 <code>digit - 1</code>，然后尝试记录每一次试除得到的余数 <code>remainder</code>。记录余数有什么用呢？在 C 语言里，判断一个数是否能被整除，用的方法是得到余数，看余数是否为 0。比如 <code>12 % 2</code> 的结果为 0，因为 12 是可以整除 2 的。</p>
<p>如果 <code>remainder</code> 为 0，说明被整除了。在除法过程里得到完全整除的现象，就标志着这个数肯定就不是质数了。比如在计算 15（<code>digit</code> 是 15）的时候，如果 <code>n</code> 此时是 3，那么 <code>remainder</code> 就是 0 了，所以 <code>digit</code> 不是质数，我们需要将结果量 <code>isPrime</code> 改为 0。 标志着这个数肯定不是质数了。</p>
<blockquote>
<p>不过，如果在得到 <code>remainder</code> 为 0 的情况时，就标志着这个数不是质数了。既然它已经肯定不是质数了，所以此时就不必再往下算了，所以我们此时想要尝试跳到循环外面，继续执行下面的语句。不过，我们目前还没有讲解这一点，所以我们先不考虑这一点的优化。哪怕后面再次遇到余数 0 的情况，因为循环里只有对 <code>isPrime = 0</code> 的赋值，所以局面完全不可能被反转，即 <code>isPrime</code> 完全不可能被重新改为 1，所以大不了多几次被赋值为 0 罢了。</p>
<p>另外，循环条件其实也可以优化，不过为了逻辑的清晰易懂，所以这里我们不提及任何有关优化的部分。</p>
</blockquote>
<p>当试除循环执行完毕，发现 <code>isPrime</code> 还是为初始赋值的情况 1，就说明在我们试除的循环里完全没有遇到余数为 0，即被整除的情况。所以这个数 <code>digit</code> 应为质数，所以我们认为这个数就是质数，输出 <code>digit</code> 是一个质数的信息，反之输出不是质数的信息。</p>
<p>所以，前面给出的算法逻辑是完整的、正确的。</p>
<h3 id="为遍历-2-到-100-写一层循环"><a href="#为遍历-2-到-100-写一层循环" class="headerlink" title="为遍历 2 到 100 写一层循环"></a>为遍历 2 到 100 写一层循环</h3><p>那么，我们既然做出了这个模块，那么，要想输出所有质数的信息，只需要把最后 <code>isPrime</code> 的判断的 <code>if</code> 条件去掉 <code>else</code> 部分，然后把输出语句改为直接输出这个数字，最后再在整个执行流程的外部加入一个 <code>while</code> 循环，计算 2 到 100 的所有数字即可。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> digit = <span class="number">2</span>, n, remainder;</span><br><span class="line"><span class="keyword">int</span> isPrime; <span class="comment">// 1 means `digit` is a prime, 0 means not.</span></span><br><span class="line"><span class="keyword">while</span> (digit &lt;= <span class="number">100</span>) <span class="comment">// Add this while-loop.</span></span><br><span class="line">&#123;</span><br><span class="line">    n = <span class="number">2</span>; <span class="comment">// Re-assign this variable.</span></span><br><span class="line">    isPrime = <span class="number">1</span>; <span class="comment">// Re-assign this variable.</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">#<span class="meta-keyword">pragma</span> region Old code</span></span><br><span class="line">    <span class="keyword">while</span> (n &lt;= digit - <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        remainder = digit % n;</span><br><span class="line">        <span class="keyword">if</span> (remainder == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// This is not a prime number.</span></span><br><span class="line">            isPrime = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        n++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isPrime)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, digit);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">pragma</span> endregion</span></span><br><span class="line"></span><br><span class="line">    digit++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，<code>Old code</code> 代码块里面的这一大堆代码都是前文用过的代码，被我原封不动地复制过来了。我们把 <code>digit</code> 从 17 改为了 2。因为我们这个题目的真正目的是为了遍历前面 100 个正整数，而 0 和 1 既不是质数也不是合数，所以我们直接从 2 开始计算。</p>
<p>然后，程序执行到 <code>digit &lt;= 100</code> 时，显然满足条件，所以进入到循环里。然后为 <code>n</code> 和 <code>isPrime</code> 进行初始化的赋值。然后进入之前的判断质数的代码块里。如果 <code>digit</code> 是质数，则肯定会进入到上述代码第 23 行代码里，并输出这个数字，然后紧跟一个空格，为了保证后面可能会输出的数字会和这个当前数字之间有一个空格的分隔。</p>
<p>然后，最后到达第 27 行代码，<code>digit</code> 会增大一个单位，比如 <code>digit</code> 从 2 变为 3，整个循环执行完毕。接着，倒回 <code>digit &lt;= 100</code> 的条件处判断。显然，它还是满足要求，所以重新进入到循环里。然后又一次对 <code>n</code> 和 <code>isPrime</code> 执行初始化的赋值。</p>
<blockquote>
<p>实际上，从这里就可以看出来，把这两句初始赋值写在循环里的原因。因为每一个不同的数字判断是否是质数的时候，都采用的是 <code>n</code> 和 <code>isPrime</code> 两个变量。重新赋值初始值是为了避免计算过后，更改了这两个变量的数值，而我们没有重新修正数值，就会影响到程序执行，并出现没有达到预期结果的 bug。</p>
</blockquote>
<p>可以看到，这一则实例用到了两层 <code>while</code> 循环，外层 <code>while</code> 循环表示的意思是，想要从 2 计算到 100，把每一个数字都判断一遍，它们是否是质数；而内层的 <code>while</code> 循环在这里表示的意思是，尝试把外层循环得到的当前需要计算的数字 <code>digit</code> 去逐个用 2 开始试除，看看这个数是否能被内层循环得到的这个数字所除尽。</p>
<h2 id="其它循环的嵌套"><a href="#其它循环的嵌套" class="headerlink" title="其它循环的嵌套"></a>其它循环的嵌套</h2><h3 id="for-循环的嵌套"><a href="#for-循环的嵌套" class="headerlink" title="for 循环的嵌套"></a><code>for</code> 循环的嵌套</h3><p><code>while</code> 循环的嵌套还是很简单的，不过 <code>for</code> 循环嵌套的理解难点就在于它的小括号的三个部分的执行顺序。只要你不要忘了 <code>for</code> 循环的执行顺序：初始值、条件、循环体、增量、条件、循环体、增量、条件、循环体、增量……</p>
<p>例如上述逻辑，就可以改写为如下的代码格式：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> digit = <span class="number">2</span>, n, remainder;</span><br><span class="line"><span class="keyword">int</span> isPrime; <span class="comment">// 1 means `digit` is a prime, 0 means not.</span></span><br><span class="line"><span class="keyword">for</span> (digit = <span class="number">2</span>; digit &lt;= <span class="number">100</span>; digit++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">2</span>, isPrime = <span class="number">1</span>; n &lt;= digit - <span class="number">1</span>; n++)</span><br><span class="line">    &#123;</span><br><span class="line">        remainder = digit % n;</span><br><span class="line">        <span class="keyword">if</span> (remainder == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// This is not a prime number.</span></span><br><span class="line">            isPrime = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (isPrime)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, digit);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上，改写代码后，代码量更少了，逻辑也清晰了，只是代码可能会稍微难理解一些。但只要你每一步按部就班地来，就不会出现逻辑执行的顺序错误。</p>
<h3 id="do-while-循环的嵌套"><a href="#do-while-循环的嵌套" class="headerlink" title="do-while 循环的嵌套"></a><code>do-while</code> 循环的嵌套</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>, j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">    j = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"*"</span>);</span><br><span class="line">        j++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (j &lt;= i);</span><br><span class="line">    </span><br><span class="line">    i++;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125; <span class="keyword">while</span> (i &lt;= <span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>用得最少的就是 <code>do-while</code> 循环了，所以它的嵌套很多时候，虽然简单，但难理解。不过一般我们都用不上，所以这里就随便举了个例，然后改写成 <code>do-while</code> 循环书写。</p>
<p>这个例子的输出结果是</p>
<script type="math/tex; mode=display">
\begin{matrix}
\text{*}\\
\text{*} & \text{*}\\
\text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
\end{matrix}</script><h2 id="循环语句的大括号省略"><a href="#循环语句的大括号省略" class="headerlink" title="循环语句的大括号省略"></a>循环语句的大括号省略</h2><p>和 <code>if</code> 语句一样，当执行循环的语句部分只有一句话的时候，我们可以去掉大括号不写，比如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i, sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++)</span><br><span class="line">    sum += i;</span><br></pre></td></tr></table></figure>
<p>它等价于</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i, sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，一个大括号也被视为一句话，所以如果 <code>for</code> 循环嵌套了例如 <code>if</code> 和大括号，或者 <code>if-else</code> 语句的话，这种形式也可以不要外层的大括号。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i, sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以简写为</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i, sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++)</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">        sum += i;</span><br></pre></td></tr></table></figure>
<p>只要你觉得看起来条理清晰的时候，就可以这么书写。</p>
<h2 id="编码技巧：枚举法"><a href="#编码技巧：枚举法" class="headerlink" title="编码技巧：枚举法"></a>编码技巧：枚举法</h2><p>枚举法就是采用大量循环的嵌套，来枚举出每一个循环的执行逻辑的一种情况，然后挨个判断条件是否满足的逻辑。这种逻辑虽然很暴力，但枚举出的所有情况保证了程序执行的正确性。</p>
<p>想必很多人听说过水仙花数字，它是一个三位数，每一个位置的数字的三次方的和，等于它自己的数字。我们既然找不到解决方式，就干脆枚举每一个情况，让每一个变量表示这个数的每一个位置，大不了用三个变量 <code>a</code>、<code>b</code> 和 <code>c</code> 表示百位、十位和个位。不过要注意，<code>a</code> 作为百位数，是不可能为 0 的，否则它就不是一个合理的三位数了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (a = <span class="number">1</span>; a &lt;= <span class="number">9</span>; a++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (b = <span class="number">0</span>; b &lt;= <span class="number">9</span>; b++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (c = <span class="number">0</span>; c &lt;= <span class="number">9</span>; c++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> digit = a * <span class="number">100</span> + b * <span class="number">10</span> + c;</span><br><span class="line">            <span class="keyword">if</span> (a * a * a + b + b * b + c * c * c == digit)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// Okay.</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d "</span>, digit);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我相信，这样的书写模式一定会让你对多重循环有一个更好的认知：首先进入 <code>a = 1</code> 的初始值赋值，然后显然满足条件，进入 <code>b = 0</code> 的初始赋值，显然满足条件，所以进入最内层的循环，<code>c = 0</code> 的初始值和条件。</p>
<p>然后全部满足，所以我们开始整合这个整数，把每一个整数合并起来变为一个整数。然后尝试对这三个数字 <code>a</code>、<code>b</code> 和 <code>c</code> 执行三次方计算再求和。如果它等于 <code>digit</code>，便满足条件，所以此时就算满足了水仙花数的要求，输出它即可。否则，我们就计算下一次循环。注意，此时循环还在最内层，所以执行完毕这一次循环的时候，应该走增量 <code>c++</code> 的这个部分，此时 <code>c</code> 表示的个位变为 1。然后再判断条件 <code>c &lt;= 9</code>。满足条件，进入循环，再一次判断条件是否满足。</p>
<p>直到 <code>c</code> 计算到 9 的时候，增量使得 <code>c</code> 变为 10，此时条件不满足。于是整个最内层的 <code>for</code> 循环执行完毕，发现它被包含在 <code>b</code> 计算的循环的这坨循环里，而这坨循环里只有关于 <code>c</code> 变量的循环一个部分，所以这便意味着 <code>b</code> 循环执行完一次操作，此时 <code>b</code> 才会增大一个单位（进入 <code>b++</code> 增量，使之变为 1）。然后再次进入 <code>c = 0</code> 的初始赋值处。</p>
<p>如果用人为的逻辑理解的话，就是把它们三个整理为 100、101、102、103、……、109、110、111、……、999 的顺序执行每一个数字。</p>
<p>大致逻辑如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (第一个维度)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (第二个维度)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (第三个维度)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 还可以有更多层次的循环。</span></span><br><span class="line">            ...</span><br><span class="line">            <span class="keyword">if</span> (条件)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 条件满足。</span></span><br><span class="line">                调用 <span class="built_in">printf</span> 函数输出结果。</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="一些练习"><a href="#一些练习" class="headerlink" title="一些练习"></a>一些练习</h2><p>嵌套循环还需要多多练习和巩固，因为它看起来简单，实际上每一步执行起来还是费工夫的。所以我们来一些练习，希望你们能够明白和看懂它们的执行。</p>
<h3 id="方阵"><a href="#方阵" class="headerlink" title="方阵"></a>方阵</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= <span class="number">5</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"* "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将会输出一个星星矩阵：</p>
<script type="math/tex; mode=display">
\begin{matrix}
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}
\end{matrix}</script><h3 id="左上三角"><a href="#左上三角" class="headerlink" title="左上三角"></a>左上三角</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= <span class="number">6</span> - i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"* "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将会是一个左上三角：</p>
<script type="math/tex; mode=display">
\begin{matrix}
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*}\\
\text{*} & \text{*}\\
\text{*}
\end{matrix}</script><h3 id="左下三角"><a href="#左下三角" class="headerlink" title="左下三角"></a>左下三角</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"* "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将会是一个左下三角：</p>
<script type="math/tex; mode=display">
\begin{matrix}
\text{*} &\\
\text{*} & \text{*}\\
\text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}
\end{matrix}</script><h3 id="右上三角"><a href="#右上三角" class="headerlink" title="右上三角"></a>右上三角</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= <span class="number">6</span> - i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"* "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将会是一个右上三角：</p>
<script type="math/tex; mode=display">
\begin{matrix}
\text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
& \text{*} & \text{*} & \text{*} & \text{*}\\
& & \text{*} & \text{*} & \text{*}\\
& & & \text{*} & \text{*}\\
& & & & \text{*}
\end{matrix}</script><h3 id="九九乘法表"><a href="#九九乘法表" class="headerlink" title="九九乘法表"></a>九九乘法表</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%2d * %2d = %2d"</span>, j, i, i * j);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样便会输出一个九九乘法表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1*1= 1</span><br><span class="line">1*2= 2 2*2= 4</span><br><span class="line">1*3= 3 2*3= 6 3*3= 9</span><br><span class="line">1*4= 4 2*4= 8 3*4=12 4*4=16</span><br><span class="line">1*5= 5 2*5=10 3*5=15 4*5=20 5*5=25</span><br><span class="line">1*6= 6 2*6=12 3*6=18 4*6=24 5*6=30 6*6=36</span><br><span class="line">1*7= 7 2*7=14 3*7=21 4*7=28 5*7=35 6*7=42 7*7=49</span><br><span class="line">1*8= 8 2*8=16 3*8=24 4*8=32 5*8=40 6*8=48 7*8=56 8*8=64</span><br><span class="line">1*9= 9 2*9=18 3*9=27 4*9=36 5*9=45 6*9=54 7*9=63 8*9=72 9*9=81</span><br></pre></td></tr></table></figure>
<h3 id="菱形"><a href="#菱形" class="headerlink" title="菱形"></a>菱形</h3><p>最难的就是这个例子了。我们尝试输出一个菱形图案。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="built_in">size</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= <span class="built_in">size</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= <span class="built_in">size</span> - i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= <span class="number">2</span> * i - <span class="number">1</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"* "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; <span class="built_in">size</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= <span class="number">2</span> * (<span class="built_in">size</span> - i) - <span class="number">1</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"* "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将会得到一个菱形图案：</p>
<script type="math/tex; mode=display">
\begin{matrix}
& & & & \text{*}\\
& & & \text{*} & \text{*} & \text{*}\\
& & \text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
& \text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
\text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*} &\\
& \text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
& & \text{*} & \text{*} & \text{*} & \text{*} & \text{*}\\
& & & \text{*} & \text{*} & \text{*}\\
& & & & \text{*}
\end{matrix}</script>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C/">C</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/">C.语法</a>►<a class="article-category-link" href="/categories/C/C-%E8%AF%AD%E6%B3%95/C-%E8%AF%AD%E6%B3%95-%E6%95%99%E7%A8%8B/">C.语法.教程</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C/">C</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>



   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/20/regex-learning/" title="正则表达式基础" itemprop="url">正则表达式基础</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-20T13:51:00.000Z" itemprop="datePublished"> 发表于 2019-11-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="什么是正则表达式？"><a href="#什么是正则表达式？" class="headerlink" title="什么是正则表达式？"></a>什么是正则表达式？</h2><blockquote>
<p><strong>正则表达式</strong>（Regular Expression）是一组由字母和符号组成的特殊文本，它可以用来从文本中找出满足你想要的格式的句子。</p>
</blockquote>
<p>一个正则表达式是一种从左到右匹配主体字符串的模式。“Regular expression”这个词比较拗口，我们常使用缩写的术语 <strong>regex</strong> 或 <strong>regexp</strong>。正则表达式可以从一个基础字符串中根据一定的匹配模式替换文本中的字符串、验证表单、提取字符串等等。</p>
<p>想象你正在写一个应用，然后你想设定一个用户命名的规则，让用户名包含字符、数字、下划线和连字符，以及限制字符的个数，好让名字看起来没那么丑。</p>
<p>我们使用以下正则表达式来验证一个用户名：</p>
<p><img src="regexp-cn.png" alt=""></p>
<p>以上的正则表达式可以接受 <code>john_doe</code>、<code>jo-hn_doe</code>、<code>john12_as</code>。 但不匹配<code>Jo</code>，因为它包含了大写的字母而且太短了。</p>
<h2 id="基本匹配"><a href="#基本匹配" class="headerlink" title="基本匹配"></a>基本匹配</h2><p>正则表达式其实就是在执行搜索时的格式，它由一些字母和数字组合而成。例如：一个正则表达式 <code>the</code>，它表示一个规则：由字母 <code>t</code> 开始，接着是 <code>h</code>，再接着是 <code>e</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;the&quot; =&gt; The fat cat sat on [the] mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/dmRygT/1" target="_blank" rel="noopener">在线练习</a></p>
<p>正则表达式 <code>123</code> 匹配字符串 <code>123</code>。它逐个字符的与输入的正则表达式做比较。</p>
<p>正则表达式是大小写敏感的，所以 <code>The</code> 不会匹配 <code>the</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;The&quot; =&gt; [The] fat cat sat on the mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/1paXsy/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h2><p>正则表达式主要依赖于元字符。元字符不代表他们本身的字面意思，他们都有特殊的含义。一些元字符写在中括号中的时候有一些特殊的意思。以下是一些元字符的介绍：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>元字符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.</code></td>
<td>句号匹配任意单个字符除了换行符。</td>
</tr>
<tr>
<td><code>[]</code></td>
<td>字符种类。匹配中括号内的任意字符。</td>
</tr>
<tr>
<td><code>[^ ]</code></td>
<td>否定的字符种类。匹配除了中括号里的任意字符。</td>
</tr>
<tr>
<td><code>*</code></td>
<td>匹配 &gt;=0 个重复的在 <code>*</code> 号之前的字符。</td>
</tr>
<tr>
<td><code>+</code></td>
<td>匹配 &gt;=1 个重复的 <code>+</code> 号前的字符。</td>
</tr>
<tr>
<td><code>?</code></td>
<td>标记 <code>?</code> 之前的字符为可选。</td>
</tr>
<tr>
<td><code>{n,m}</code></td>
<td>匹配 $p$ 个大括号之间的字符（其中 $n \leq p \leq m$)。</td>
</tr>
<tr>
<td><code>(xyz)</code></td>
<td>字符集，匹配与 <code>xyz</code> 完全相等的字符串。</td>
</tr>
<tr>
<td><code>&#124;</code></td>
<td>或运算符，匹配符号前或后的字符。</td>
</tr>
<tr>
<td><code>\</code></td>
<td>转义字符，用于匹配一些保留的字符 <code>[ ] ( ) { } . * + ? ^ $ \ &#124;</code>。</td>
</tr>
<tr>
<td><code>^</code></td>
<td>从开始行开始匹配。</td>
</tr>
<tr>
<td><code>$</code></td>
<td>从末端开始匹配。</td>
</tr>
</tbody>
</table>
</div>
<h2 id="点运算符"><a href="#点运算符" class="headerlink" title="点运算符 ."></a>点运算符 <code>.</code></h2><p><code>.</code> 是元字符中最简单的例子。<code>.</code> 匹配任意单个字符，但不匹配换行符。例如，表达式 <code>.ar</code> 匹配一个任意字符后面跟着是<code>a</code>和<code>r</code>的字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;.ar&quot; =&gt; [The] [car] [par]ked in the [gar]age.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/xc9GkU/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="字符集"><a href="#字符集" class="headerlink" title="字符集"></a>字符集</h2><p>字符集也叫做字符类。中括号用来指定一个字符集。 在中括号中使用连字符来指定字符集的范围。 在中括号中的字符集不关心顺序。 例如，表达式 <code>[Tt]he</code> 匹配 <code>the</code> 和 <code>The</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[Tt]he&quot; =&gt; [The] car parked in [the] garage.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/2ITLQ4/1" target="_blank" rel="noopener">在线练习</a></p>
<p>中括号的句号就表示句号。 表达式 <code>ar[.]</code> 匹配 <code>ar.</code>字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;ar[.]&quot; =&gt; A garage is a good place to park a c[ar.]</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/wL3xtE/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="否定字符集"><a href="#否定字符集" class="headerlink" title="否定字符集"></a>否定字符集</h3><p>一般来说 <code>^</code> 表示一个字符串的开头，但它用在一个中括号的开头的时候，它表示这个字符集是否定的。 例如，表达式<code>[^c]ar</code> 匹配一个后面跟着<code>ar</code>的除了<code>c</code>的任意字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[^c]ar&quot; =&gt; The car [par]ked in the [gar]age.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/nNNlq3/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="重复次数"><a href="#重复次数" class="headerlink" title="重复次数"></a>重复次数</h2><p>后面跟着元字符 <code>+</code>，<code>*</code> 或 <code>?</code> 的，用来指定匹配子模式的次数。 这些元字符在不同的情况下有着不同的意思。</p>
<h3 id="号"><a href="#号" class="headerlink" title="* 号"></a><code>*</code> 号</h3><p><code>*</code> 号匹配 在 <code>*</code> 之前的字符出现<strong>大于等于 0</strong>次。 例如，表达式 <code>a*</code> 匹配0或更多个以 <code>a</code> 开头的字符。表达式 <code>[a-z]*</code> 匹配一个行中所有以小写字母开头的字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[a-z]*&quot; =&gt; T[he] [car] [parked] [in] [the] [garage] #21.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/7m8me5/1" target="_blank" rel="noopener">在线练习</a></p>
<p><code>*</code> 字符和 <code>.</code> 字符搭配可以匹配所有的字符 <code>.*</code>。<code>*</code> 和表示匹配空格的符号 <code>\s</code> 连起来用，如表达式 <code>\s*cat\s*</code> 匹配 <code>0</code> 或更多个空格开头和 <code>0</code>或更多个空格结尾的 <code>cat</code> 字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;\s*cat\s*&quot; =&gt; The fat [cat] sat on the con[cat]enation.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/gGrwuz/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="号-1"><a href="#号-1" class="headerlink" title="+ 号"></a><code>+</code> 号</h3><p><code>+</code> 号匹配 <code>+</code> 号之前的字符<strong>出现 &gt;=1 次</strong>。 例如表达式 <code>c.+t</code> 匹配以首字母 <code>c</code> 开头以 <code>t</code> 结尾，中间跟着至少一个字符的字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;c.+t&quot; =&gt; The fat [cat sat on the mat].</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/Dzf9Aa/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="号-2"><a href="#号-2" class="headerlink" title="? 号"></a><code>?</code> 号</h3><p>在正则表达式中元字符 <code>?</code> 标记在符号前面的字符为可选，即<strong>出现 0 或 1 次</strong>。 例如，表达式 <code>[T]?he</code> 匹配字符串 <code>he</code> 和 <code>The</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[T]he&quot; =&gt; [The] car is parked in the garage.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/cIg9zm/1" target="_blank" rel="noopener">在线练习</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[T]?he&quot; =&gt; [The] car is parked in t[he] garage.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/kPpO2x/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="号-3"><a href="#号-3" class="headerlink" title="{} 号"></a><code>{}</code> 号</h2><p>在正则表达式中 <code>{}</code> 是一个量词，常用来一个或一组字符可以重复出现的次数。例如，表达式 <code>[0-9]{2,3}</code> 匹配最少 2 位最多 3 位 0~9 的数字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[0-9]&#123;2,3&#125;&quot; =&gt; The number was 9.[999]7 but we rounded it off to [10].0.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/juM86s/1" target="_blank" rel="noopener">在线练习</a></p>
<p>我们可以省略第二个参数。 例如，<code>[0-9]{2,}</code> 匹配至少两位 0~9 的数字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[0-9]&#123;2,&#125;&quot; =&gt; The number was 9.[9997] but we rounded it off to [10].0.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/Gdy4w5/1" target="_blank" rel="noopener">在线练习</a></p>
<p>如果逗号也省略掉则表示重复固定的次数。 例如，<code>[0-9]{3}</code> 匹配3位数字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;[0-9]&#123;3&#125;&quot; =&gt; The number was 9.[999]7 but we rounded it off to 10.0.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/Sivu30/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="特征标群"><a href="#特征标群" class="headerlink" title="(...) 特征标群"></a><code>(...)</code> 特征标群</h2><p>特征标群是一组写在 <code>(...)</code> 中的子模式。例如之前说的 <code>{}</code> 是用来表示前面一个字符出现指定次数。但如果在 <code>{}</code> 前加入特征标群则表示整个标群内的字符重复 N 次。例如，表达式 <code>(ab)*</code> 匹配连续出现 0 或更多个 <code>ab</code>。</p>
<p>我们还可以在 <code>()</code> 中用或字符 <code>|</code> 表示或。例如，<code>(c|g|p)ar</code> 匹配 <code>car</code> 或 <code>gar</code> 或 <code>par</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(c|g|p)ar&quot; =&gt; The [car] is [par]ked in the [gar]age.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/tUxrBG/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="或运算符"><a href="#或运算符" class="headerlink" title="| 或运算符"></a><code>|</code> 或运算符</h2><p>或运算符就表示或，用作判断条件。</p>
<p>例如 <code>(T|t)he|car</code> 匹配 <code>(T|t)he</code> 或 <code>car</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(T|t)he|car&quot; =&gt; [The] [car] is parked in [the] garage.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/fBXyX0/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="转码特殊字符"><a href="#转码特殊字符" class="headerlink" title="转码特殊字符"></a>转码特殊字符</h2><p>反斜线 <code>\</code> 在表达式中用于转码紧跟其后的字符。用于指定 <code>{ } [ ] / \ + * . $ ^ | ?</code> 这些特殊字符。如果想要匹配这些特殊字符则要在其前面加上反斜线 <code>\</code>。</p>
<p>例如 <code>.</code> 是用来匹配除换行符外的所有字符的。如果想要匹配句子中的 <code>.</code> 则要写成 <code>\.</code> 以下这个例子 <code>\.?</code>是选择性匹配<code>.</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(f|c|m)at\.?&quot; =&gt; The [fat] [cat] sat on the [mat.]</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/DOc5Nu/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="锚点"><a href="#锚点" class="headerlink" title="锚点"></a>锚点</h2><p>在正则表达式中，想要匹配指定开头或结尾的字符串就要使用到锚点。<code>^</code> 指定开头，<code>$</code> 指定结尾。</p>
<h3 id="号-4"><a href="#号-4" class="headerlink" title="^ 号"></a><code>^</code> 号</h3><p><code>^</code> 用来检查匹配的字符串是否在所匹配字符串的开头。</p>
<p>例如，在 <code>abc</code> 中使用表达式 <code>^a</code> 会得到结果 <code>a</code>。但如果使用 <code>^b</code> 将匹配不到任何结果。因为在字符串 <code>abc</code> 中并不是以 <code>b</code>开头。</p>
<p>例如，<code>^(T|t)he</code> 匹配以 <code>The</code> 或 <code>the</code> 开头的字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(T|t)he&quot; =&gt; [The] car is parked in [the] garage.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/5ljjgB/1" target="_blank" rel="noopener">在线练习</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;^(T|t)he&quot; =&gt; [The] car is parked in the garage.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/jXrKne/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="号-5"><a href="#号-5" class="headerlink" title="$ 号"></a><code>$</code> 号</h3><p>同理于 <code>^</code> 号，<code>$</code> 号用来匹配字符是否是最后一个。</p>
<p>例如，<code>(at\.)$</code> 匹配以 <code>at.</code> 结尾的字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(at\.)&quot; =&gt; The fat c[at.] s[at.] on the m[at.]</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/y4Au4D/1" target="_blank" rel="noopener">在线练习</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(at\.)$&quot; =&gt; The fat cat. sat. on the m[at.]</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/t0AkOd/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="简写字符集"><a href="#简写字符集" class="headerlink" title="简写字符集"></a>简写字符集</h2><p>正则表达式提供一些常用的字符集简写。如下:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>简写</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>.</td>
<td>除换行符外的所有字符。</td>
</tr>
<tr>
<td>\w</td>
<td>匹配所有字母数字，等同于 <code>[a-zA-Z0-9_]</code>。</td>
</tr>
<tr>
<td>\W</td>
<td>匹配所有非字母数字，即符号，等同于： <code>[^\w]</code>。</td>
</tr>
<tr>
<td>\d</td>
<td>匹配数字： <code>[0-9]</code>。</td>
</tr>
<tr>
<td>\D</td>
<td>匹配非数字： <code>[^\d]</code>。</td>
</tr>
<tr>
<td>\s</td>
<td>匹配所有空格字符，等同于： <code>[\t\n\f\r\p{Z}]</code>。</td>
</tr>
<tr>
<td>\S</td>
<td>匹配所有非空格字符： <code>[^\s]</code>。</td>
</tr>
<tr>
<td>\f</td>
<td>匹配一个换页符。</td>
</tr>
<tr>
<td>\n</td>
<td>匹配一个换行符。</td>
</tr>
<tr>
<td>\r</td>
<td>匹配一个回车符。</td>
</tr>
<tr>
<td>\t</td>
<td>匹配一个制表符。</td>
</tr>
<tr>
<td>\v</td>
<td>匹配一个垂直制表符。</td>
</tr>
<tr>
<td>\p</td>
<td>匹配 CR/LF（等同于 <code>\r\n</code>），用来匹配 DOS 行终止符。</td>
</tr>
</tbody>
</table>
</div>
<h2 id="零宽度断言（前后预查）"><a href="#零宽度断言（前后预查）" class="headerlink" title="零宽度断言（前后预查）"></a>零宽度断言（前后预查）</h2><p>先行断言和后发断言都属于<strong>非捕获簇</strong>（不捕获文本，也不针对组合计进行计数）。先行断言用于判断所匹配的格式是否在另一个确定的格式之前，匹配结果不包含该确定格式（仅作为约束）。</p>
<p>例如，我们想要获得所有跟在 <script type="math/tex">` 符号后的数字，我们可以使用正后发断言 `(?<=\$)[0-9\.]*`。 这个表达式匹配 `</script> 开头，之后跟着 <code>0,1,2,3,4,5,6,7,8,9,.</code> 这些字符可以出现大于等于 0 次。</p>
<p>零宽度断言如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>符号</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>?=</td>
<td>正先行断言-存在</td>
</tr>
<tr>
<td>?!</td>
<td>负先行断言-排除</td>
</tr>
<tr>
<td>?&lt;=</td>
<td>正后发断言-存在</td>
</tr>
<tr>
<td>?&lt;!</td>
<td>负后发断言-排除</td>
</tr>
</tbody>
</table>
</div>
<h3 id="正先行断言"><a href="#正先行断言" class="headerlink" title="?=... 正先行断言"></a><code>?=...</code> 正先行断言</h3><p><code>?=...</code> 正先行断言，表示第一部分表达式之后必须跟着 <code>?=...</code>定义的表达式。</p>
<p>返回结果只包含满足匹配条件的第一部分表达式。定义一个正先行断言要使用 <code>()</code>。在括号内部使用一个问号和等号：<code>(?=...)</code>。</p>
<p>正先行断言的内容写在括号中的等号后面。例如，表达式 <code>(T|t)he(?=\sfat)</code> 匹配 <code>The</code> 和 <code>the</code>，在括号中我们又定义了正先行断言 <code>(?=\sfat)</code>，即 <code>The</code> 和 <code>the</code> 后面紧跟着 <code>(空格)fat</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(T|t)he(?=\sfat)&quot; =&gt; [The] fat cat sat on the mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/IDDARt/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="负先行断言"><a href="#负先行断言" class="headerlink" title="?!... 负先行断言"></a><code>?!...</code> 负先行断言</h3><p>负先行断言 <code>?!</code> 用于筛选所有匹配结果，筛选条件为 其后不跟随着断言中定义的格式。 <code>正先行断言</code> 定义和 <code>负先行断言</code> 一样，区别就是 <code>=</code> 替换成 <code>!</code> 也就是 <code>(?!...)</code>。</p>
<p>表达式 <code>(T|t)he(?!\sfat)</code> 匹配 <code>The</code> 和 <code>the</code>，且其后不跟着 <code>(空格)fat</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(T|t)he(?!\sfat)&quot; =&gt; The fat cat sat on [the] mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/V32Npg/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="lt-正后发断言"><a href="#lt-正后发断言" class="headerlink" title="?&lt;= ... 正后发断言"></a><code>?&lt;= ...</code> 正后发断言</h3><p>正后发断言 记作<code>(?&lt;=...)</code> 用于筛选所有匹配结果，筛选条件为 其前跟随着断言中定义的格式。 例如，表达式 <code>(?&lt;=(T|t)he\s)(fat|mat)</code> 匹配 <code>fat</code> 和 <code>mat</code>，且其前跟着 <code>The</code> 或 <code>the</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(?&lt;=(T|t)he\s)(fat|mat)&quot; =&gt; The [fat] cat sat on the [mat].</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/avH165/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="负后发断言"><a href="#负后发断言" class="headerlink" title="? 负后发断言"></a><code>?</code> 负后发断言</h3><p>负后发断言 记作 <code>(?</code> 用于筛选所有匹配结果，筛选条件为 其前不跟随着断言中定义的格式。例如，表达式 <code>(?</code> 匹配 <code>cat</code>，且其前不跟着 <code>The</code> 或 <code>the</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;(?&lt;!(T|t)he\s)(cat)&quot; =&gt; The cat sat on [cat].</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/8Efx5G/1" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="标志"><a href="#标志" class="headerlink" title="标志"></a>标志</h2><p>标志也叫模式修正符，因为它可以用来修改表达式的搜索结果。这些标志可以任意的组合使用，它也是整个正则表达式的一部分。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>标志</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>i</td>
<td>忽略大小写。</td>
</tr>
<tr>
<td>g</td>
<td>全局搜索。</td>
</tr>
<tr>
<td>m</td>
<td>多行修饰符：锚点元字符 <code>^</code> <code>$</code> 工作范围在每行的起始。</td>
</tr>
</tbody>
</table>
</div>
<h3 id="忽略大小写（Case-Insensitive）"><a href="#忽略大小写（Case-Insensitive）" class="headerlink" title="忽略大小写（Case Insensitive）"></a>忽略大小写（Case Insensitive）</h3><p>修饰语 <code>i</code> 用于忽略大小写。 例如，表达式 <code>/The/gi</code> 表示在全局搜索 <code>The</code>，在后面的 <code>i</code> 将其条件修改为忽略大小写，则变成搜索 <code>the</code> 和 <code>The</code>，<code>g</code> 表示全局搜索。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;The&quot; =&gt; [The] fat cat sat on the mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/dpQyf9/1" target="_blank" rel="noopener">在线练习</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;/The/gi&quot; =&gt; [The] fat cat sat on [the] mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/ahfiuh/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="全局搜索（Global-search）"><a href="#全局搜索（Global-search）" class="headerlink" title="全局搜索（Global search）"></a>全局搜索（Global search）</h3><p>修饰符 <code>g</code> 常用于执行一个全局搜索匹配，即“不仅仅返回第一个匹配的，而是返回全部”。例如，表达式 <code>/.(at)/g</code> 表示搜索 <code>除换行外的任意字符 + at</code>，并返回全部结果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;/.(at)/&quot; =&gt; The [fat] cat sat on the mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/jnk6gM/1" target="_blank" rel="noopener">在线练习</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;/.(at)/g&quot; =&gt; The [fat] [cat] [sat] on the [mat].</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/dO1nef/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="多行修饰符（Multiline）"><a href="#多行修饰符（Multiline）" class="headerlink" title="多行修饰符（Multiline）"></a>多行修饰符（Multiline）</h3><p>多行修饰符 <code>m</code> 常用于执行一个多行匹配。</p>
<p>像之前介绍的 <code>(^,$)</code> 用于检查格式是否是在待检测字符串的开头或结尾。但我们如果想要它在每行的开头和结尾生效，我们需要用到多行修饰符 <code>m</code>。</p>
<p>例如，表达式 <code>/at(.)?$/gm</code> 表示小写字符 <code>a</code> 后跟小写字符 <code>t</code>，末尾可选除换行符外任意字符。根据 <code>m</code> 修饰符，现在表达式匹配每行的结尾。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;/.at(.)?$/&quot; =&gt; The fat</span><br><span class="line">                cat sat</span><br><span class="line">                on the [mat].</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/hoGMkP/1" target="_blank" rel="noopener">在线练习</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;/.at(.)?$/gm&quot; =&gt; The [fat]</span><br><span class="line">                  cat [sat]</span><br><span class="line">                  on the [mat].</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/E88WE2/1" target="_blank" rel="noopener">在线练习</a></p>
<h3 id="贪婪匹配与惰性匹配（Greedy-vs-lazy-matching）"><a href="#贪婪匹配与惰性匹配（Greedy-vs-lazy-matching）" class="headerlink" title="贪婪匹配与惰性匹配（Greedy vs lazy matching）"></a>贪婪匹配与惰性匹配（Greedy vs lazy matching）</h3><p>正则表达式默认采用贪婪匹配模式，在该模式下意味着会匹配尽可能长的子串。我们可以使用 <code>?</code> 将贪婪匹配模式转化为惰性匹配模式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;/(.*at)/&quot; =&gt; [The fat cat sat on the mat].</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/AyAdgJ/1" target="_blank" rel="noopener">在线练习</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;/(.*?at)/&quot; =&gt; [The fat] cat sat on the mat.</span><br></pre></td></tr></table></figure>
<p><a href="https://regex101.com/r/AyAdgJ/2" target="_blank" rel="noopener">在线练习</a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://github.com/ziishaned/learn-regex/blob/master/translations/README-cn.md" target="_blank" rel="noopener">这篇文章</a>（都来自这篇文章）</li>
</ul>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/正则表达式/">正则表达式</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>



   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/20/csharp-fraction-struct/" title="C# 实现一个分数类型的结构" itemprop="url">C# 实现一个分数类型的结构</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-20T13:45:28.000Z" itemprop="datePublished"> 发表于 2019-11-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="让我们愉快地写一个分数结构吧！"><a href="#让我们愉快地写一个分数结构吧！" class="headerlink" title="让我们愉快地写一个分数结构吧！"></a>让我们愉快地写一个分数结构吧！</h2><p>因为分数的类型比较轻量级，仅包含两个字段，所以我们可以使用值类型。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">readonly</span> <span class="keyword">struct</span> Fraction : IEquatable&lt;Fraction&gt;, IComparable&lt;Fraction&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Fraction Zero = <span class="keyword">new</span> Fraction(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Fraction One = <span class="keyword">new</span> Fraction(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Fraction MinusOne = <span class="keyword">new</span> Fraction(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="keyword">int</span> gcd;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Fraction</span>(<span class="params"><span class="keyword">int</span> numerator</span>) : <span class="title">this</span>(<span class="params">numerator, <span class="number">1</span></span>)</span> &#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Fraction</span>(<span class="params"><span class="keyword">int</span> numerator, <span class="keyword">int</span> denominator</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        gcd = GetGcd(Math.Abs(numerator), Math.Abs(denominator));</span><br><span class="line">        Numerator = Deduct(numerator, gcd);</span><br><span class="line">        Denominator = Deduct(denominator, gcd);</span><br><span class="line">        IsPositive = !(numerator &gt; <span class="number">0</span> ^ denominator &gt; <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Deduct</span>(<span class="params"><span class="keyword">int</span> digit, <span class="keyword">int</span> gcd</span>)</span> =&gt; Math.Abs(digit) / gcd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">bool</span> IsPositive &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">decimal</span> Value =&gt; (<span class="keyword">decimal</span>)Numerator / Denominator;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Numerator &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Denominator &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Fraction Nagate =&gt; <span class="keyword">new</span> Fraction(-Numerator, Denominator);</span><br><span class="line">    <span class="keyword">public</span> Fraction Reciprocal =&gt; <span class="keyword">new</span> Fraction(Denominator, Numerator);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">CompareTo</span>(<span class="params">Fraction other</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">this</span> - other;</span><br><span class="line">        <span class="keyword">return</span> result &gt; <span class="number">0</span> ? <span class="number">1</span> : result &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">CompareTo</span>(<span class="params"><span class="keyword">int</span> other</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> other == <span class="number">0</span> ? Numerator == <span class="number">0</span> ? <span class="number">0</span> : IsPositive ? <span class="number">1</span> : <span class="number">-1</span> : CompareTo((Fraction)other);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">Truncate</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)Value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">TruncatingDivide</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(<span class="keyword">this</span> / fraction);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">bool</span> <span class="title">Equals</span>(<span class="params"><span class="keyword">object</span>? obj</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> obj <span class="keyword">is</span> Fraction comparer &amp;&amp; Equals(comparer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">Equals</span>(<span class="params">Fraction other</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Numerator == other.Numerator &amp;&amp; Denominator == other.Denominator;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">int</span> <span class="title">GetHashCode</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Value.GetHashCode();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">string</span> <span class="title">ToString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$"<span class="subst">&#123;(IsPositive ? <span class="string">""</span> : <span class="string">"-"</span>)&#125;</span><span class="subst">&#123;Numerator&#125;</span><span class="subst">&#123;(Denominator == <span class="number">1</span> ? <span class="string">""</span> : <span class="string">$"/<span class="subst">&#123;Denominator&#125;</span>"</span>)&#125;</span>"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SuppressMessage(<span class="meta-string">"Design"</span>, <span class="meta-string">"CA1031:Do not catch general exception types"</span>, Justification = <span class="meta-string">"&lt;Pending&gt;"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">TryParse</span>(<span class="params"><span class="keyword">string</span> str, [NotNullWhen(<span class="literal">true</span></span>)] <span class="keyword">out</span> Fraction? result)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            result = Parse(str);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            result = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="title">Parse</span>(<span class="params"><span class="keyword">string</span> str</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (str.Contains(<span class="string">'/'</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">string</span> digitPattern = <span class="string">@"[+-]?\d+"</span>;</span><br><span class="line">            <span class="keyword">var</span> match = <span class="keyword">new</span> Regex(<span class="string">$@"<span class="subst">&#123;digitPattern&#125;</span>/\s*<span class="subst">&#123;digitPattern&#125;</span>"</span>).Match(str);</span><br><span class="line">            <span class="keyword">if</span> (match.Success)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> mc = <span class="keyword">new</span> Regex(digitPattern).Matches(str);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Fraction(<span class="keyword">int</span>.Parse(mc[<span class="number">0</span>].Value), <span class="keyword">int</span>.Parse(mc[<span class="number">1</span>].Value));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// Parse failed.</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">"Cannot parse value to target type."</span>, <span class="keyword">nameof</span>(str));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Fraction(<span class="keyword">int</span>.Parse(str));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">GetGcd</span>(<span class="params"><span class="keyword">int</span> a, <span class="keyword">int</span> b</span>)</span> =&gt; b == <span class="number">0</span> ? a : GetGcd(b, a % b);</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">GetLcm</span>(<span class="params"><span class="keyword">int</span> a, <span class="keyword">int</span> b</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">int</span> gcd = GetGcd(a, b);</span><br><span class="line">        <span class="keyword">return</span> Math.Max(a / gcd, b / gcd) * gcd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> +(Fraction fraction) =&gt; fraction;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> -(Fraction fraction) =&gt; fraction.Nagate;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> ++(Fraction fraction) =&gt; fraction + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> --(Fraction fraction) =&gt; fraction - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> +(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> (a, b, c, d) = (left.Numerator, left.Denominator, right.Numerator, right.Denominator);</span><br><span class="line">        <span class="keyword">var</span> (s1, s2) = (left.IsPositive, right.IsPositive);</span><br><span class="line">        <span class="keyword">int</span> lcm = GetLcm(b, d);</span><br><span class="line">        a *= lcm / b;</span><br><span class="line">        c *= lcm / d;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Fraction((s1 ? a : -a) + (s2 ? c : -c), lcm);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> -(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left + right.Nagate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> *(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> (a, b, c, d) = (left.Numerator, left.Denominator, right.Numerator, right.Denominator);</span><br><span class="line">        <span class="keyword">bool</span> isPositive = !(left.IsPositive ^ right.IsPositive);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Fraction((isPositive ? a : -a) * c, b * d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> /(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left * right.Reciprocal;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="keyword">operator</span> %(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left - right * left.TruncatingDivide(right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="keyword">operator</span> ==(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left.Equals(right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="keyword">operator</span> !=(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> !left.Equals(right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left.CompareTo(right) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left.CompareTo(right) &lt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;=(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left.CompareTo(right) &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;=(Fraction left, Fraction right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> left.CompareTo(right) &lt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">byte</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">byte</span>)fraction.Value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">short</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">short</span>)fraction.Value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">int</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> fraction.Truncate();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">long</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">long</span>)fraction.Value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> <span class="title">float</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">float</span>)fraction.Value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> <span class="title">double</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">double</span>)fraction.Value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> <span class="title">decimal</span>(<span class="params">Fraction fraction</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> fraction.Value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> <span class="title">Fraction</span>(<span class="params"><span class="keyword">int</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Fraction(<span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C%E2%99%AF/">C♯</a>►<a class="article-category-link" href="/categories/C%E2%99%AF/C%E2%99%AF-%E6%95%B0%E5%AD%A6/">C♯.数学</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C♯/">C♯</a><a href="/tags/数学/">数学</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>



   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/20/csharp-regex-util/" title="C# 的正则表达式用法" itemprop="url">C# 的正则表达式用法</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-20T11:24:21.000Z" itemprop="datePublished"> 发表于 2019-11-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="什么是正则表达式？"><a href="#什么是正则表达式？" class="headerlink" title="什么是正则表达式？"></a>什么是正则表达式？</h2><p>正则表达式是一种机制，可以从一个字符串里快速提取指定内容格式的信息，比如在</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello, world</span><br></pre></td></tr></table></figure>
<p>里提取出所有的单词信息，用正则表达式可以写作 <code>[A-Za-z]+</code>，这样就能得到与这个表达式所匹配的 <code>Hello</code> 和 <code>world</code> 两个单词。</p>
<p>但是，具体怎么使用正则表达式，语法有哪些，并不在本文里给出，可以参考网络上的正则表达式的文章，或是这个 GitHub 上的<a href="https://github.com/ziishaned/learn-regex" target="_blank" rel="noopener">正则表达式学习 repo</a>。不过在使用所有下面的内容之前，你需要先使用命名空间 <code>System.Text.RegularExpression</code>。</p>
<h2 id="Regex-类"><a href="#Regex-类" class="headerlink" title="Regex 类"></a><code>Regex</code> 类</h2><p>使用 <code>Regex</code> 类，并以正则表达式的字符串写法，可以实例化一个正则表达式的对象。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> wordRegex = <span class="keyword">new</span> Regex(<span class="string">@"[A-Za-z]+"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="Match-和-MatchCollection-类"><a href="#Match-和-MatchCollection-类" class="headerlink" title="Match 和 MatchCollection 类"></a><code>Match</code> 和 <code>MatchCollection</code> 类</h2><p>在通过实例化对象后，使用 <code>Match</code> 和 <code>Matches</code> 方法可以获取所有匹配项，只不过，<code>Match</code> 方法执行的结果是 <code>Match</code> 类类型的数据，它表示只提取所有满足条件的一个，而 <code>Matches</code> 方法执行的结果是一个 <code>MatchCollection</code> 类类型的对象，表示所有满足条件的匹配项目。不过，它们提取出来的内容都是封装好的对象，需要使用 <code>Value</code> 属性获取信息。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">string</span> str = <span class="string">"Hello, world"</span>;</span><br><span class="line"><span class="keyword">var</span> wordRegex = <span class="keyword">new</span> Regex(<span class="string">@"[A-Za-z]+"</span>);</span><br><span class="line"><span class="keyword">var</span> match = wordRegex.Match(str);</span><br><span class="line"><span class="keyword">var</span> matchCollection = wordRegex.Matches(str);</span><br><span class="line">Console.WriteLine(match.Value);</span><br><span class="line">Console.WriteLine(matchCollection[<span class="number">0</span>].Value);</span><br><span class="line">Console.WriteLine(matchCollection[<span class="number">1</span>].Value);</span><br></pre></td></tr></table></figure>
<p>调用 <code>MatchCollection</code> 对象的方法是，通过中括号索引来获取，或者通过 <code>foreach</code> 循环获取每一个对象，再使用 <code>Value</code> 属性获取匹配的具体内容。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> m <span class="keyword">in</span> matchCollection) <span class="comment">// m is object.</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine((m <span class="keyword">as</span> Match).Value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Or</span></span><br><span class="line"><span class="keyword">foreach</span> (Match m <span class="keyword">in</span> matchCollection)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(m.Value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>稍微注意的是，<code>MatchCollection</code> 同时实现了 <code>IEnumerable</code> 和 <code>IEnumerable&lt;Match&gt;</code> 接口，这使得上述两种 <code>foreach</code> 循环均成立。但如果对迭代的每一个对象使用 <code>var</code> 关键字，它将会被当作 <code>object</code>，这是因为在 API 里，隐式实现接口的模式是 <code>IEnumerable</code>，而不是那个泛型接口。</p>
<h2 id="IsMatch-方法"><a href="#IsMatch-方法" class="headerlink" title="IsMatch 方法"></a><code>IsMatch</code> 方法</h2><p>另外，你可以使用 <code>IsMatch</code> 方法来判断匹配是否成功（即匹配后是否包含有匹配项）。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> isSuccess = <span class="keyword">new</span> Regex(<span class="string">@"[A-Za-z]+"</span>).IsMatch(str);</span><br></pre></td></tr></table></figure>
<p>如果 <code>isSuccess</code> 是 <code>false</code>，则表示不包含。</p>
<h2 id="构造器的精细化处理"><a href="#构造器的精细化处理" class="headerlink" title="构造器的精细化处理"></a>构造器的精细化处理</h2><p>我们甚至可以通过构造器的参数来设置匹配的更多细节，比如超时等。</p>
<p>C# 为我们提供了三个不同的构造器：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Regex</span>(<span class="params"><span class="keyword">string</span> pattern</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Regex</span>(<span class="params"><span class="keyword">string</span> pattern, RegexOptions options</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Regex</span>(<span class="params"><span class="keyword">string</span> pattern, RegexOptions options, TimeSpan matchTimeout</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>第一个参数是传入一个正则表达式的字符串格式写法（即上面的 <code>[A-Za-z]+</code>），第二个参数是匹配方式，它是一个枚举值，它包含如下的枚举结果：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> RegexOptions</span><br><span class="line">&#123;</span><br><span class="line">    None = <span class="number">0</span>,</span><br><span class="line">    IgnoreCase = <span class="number">1</span>,</span><br><span class="line">    Multiline = <span class="number">2</span>,</span><br><span class="line">    ExplicitCapture = <span class="number">4</span>,</span><br><span class="line">    Compiled = <span class="number">8</span>,</span><br><span class="line">    Singleline = <span class="number">16</span>,</span><br><span class="line">    IgnorePatternWhitespace = <span class="number">32</span>,</span><br><span class="line">    RightToLeft = <span class="number">64</span>,</span><br><span class="line">    ECMAScript = <span class="number">256</span>,</span><br><span class="line">    CultureInvariant = <span class="number">512</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们不必都讲，默认是传入 <code>RegexOptions.None</code> 的。到时候查文档就可以了。</p>
<p>第三个参数是传入一个超时的时长 <code>TimeSpan</code> 结构对象。当匹配过程超出这个时间的时候将会直接抛出 <code>RegexMatchTimeoutException</code> 异常（这个是确定的），表示匹配超时。所以如果你在传入第三个参数时，就一定要想着去捕获可能抛出的这个异常。</p>
<blockquote>
<p>如果在 Java 里，这个机制就更加类似于 Checked Exception 了。</p>
</blockquote>
<h2 id="使用实例"><a href="#使用实例" class="headerlink" title="使用实例"></a>使用实例</h2><p>下面来一个实例。假设我们在设计一个分数类 <code>Fraction</code> 的时候需要解析字符串，并生成指定的分数对象。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Fraction <span class="title">Parse</span>(<span class="params"><span class="keyword">string</span> str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">string</span> digitPattern = <span class="string">@"[+-]?\d+"</span>;</span><br><span class="line">    <span class="keyword">var</span> match = <span class="keyword">new</span> Regex(<span class="string">$@"<span class="subst">&#123;digitPattern&#125;</span>/\s*<span class="subst">&#123;digitPattern&#125;</span>"</span>).Match(str);</span><br><span class="line">    <span class="keyword">if</span> (match.Success)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> mc = <span class="keyword">new</span> Regex(digitPattern).Matches(str);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Fraction(<span class="keyword">int</span>.Parse(mc[<span class="number">0</span>].Value), <span class="keyword">int</span>.Parse(mc[<span class="number">1</span>].Value));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Parse failed.</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(</span><br><span class="line">            <span class="string">"Cannot parse value to target type."</span>, <span class="keyword">nameof</span>(str));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">SuppressMessage(<span class="meta-string">"Design"</span>, <span class="meta-string">"CA1031:Do not catch general exception types"</span>, Justification = <span class="meta-string">"&lt;Pending&gt;"</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">TryParse</span>(<span class="params"><span class="keyword">string</span> str, [NotNullWhen(<span class="literal">true</span></span>)] <span class="keyword">out</span> Fraction? result)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        result = Parse(str);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span></span><br><span class="line">    &#123;</span><br><span class="line">        result = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试结果如下：</p>
<p><img src="fraction-test.png" alt=""></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C%E2%99%AF/">C♯</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C♯/">C♯</a><a href="/tags/正则表达式/">正则表达式</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>



   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/11/19/csharp-complier-generating-auto-property/" title="C# 里自动属性特性的编译器生成" itemprop="url">C# 里自动属性特性的编译器生成</a>
    
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="向向" target="_blank" itemprop="author">向向</a>
		
  <p class="article-time">
    <time datetime="2019-11-19T13:02:37.000Z" itemprop="datePublished"> 发表于 2019-11-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="属性和自动属性都是什么？"><a href="#属性和自动属性都是什么？" class="headerlink" title="属性和自动属性都是什么？"></a>属性和自动属性都是什么？</h2><p>属性在 C# 里是一个非常重要的概念。在 Java 里是没有这个概念的，它可以类比表示一种封装机制，将内部使用的字段通过 <code>getxxx</code> 和 <code>setxxx</code> 方法存取数据，暴露给外部，使得程序员可以更轻松地发现哪些字段可以被看到，并赋值和读取。这种封装机制在 C# 得到了简化。</p>
<p>最初的 C# 提供了属性机制，它是 Java 这种封装机制的整合工具。比如在 Java 里，封装一个字段的信息需要两个方法和一个字段，所以格式是这样的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Class</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 C# 里变为了这样的书写格式：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Age</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">this</span>.age; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; <span class="keyword">this</span>.age = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，它为这种封装机制取了个名，叫做 <code>Age</code>，它就是属性。这是一种约定俗成的习惯。我们习惯把属性的名称和字段的名字用到的词汇搞成一样的，只是字段用驼峰命名法（第一个单词首字母小写，后出现的单词每一个单词都大写首字母），而属性用帕斯卡命名法（所有单词用大写首字母的方式分隔）。</p>
<p>属性在前面配上了类似于返回值的写法，比如上述的第 5 行 <code>public int Age</code> 的 <code>int</code> 是作为属性在获取值和赋值过程之中用到的类型。比如 <code>Age</code> 为 <code>age</code> 字段提供赋值和获取值的两个工作。获取值的返回值是 <code>int</code>，而赋值用的是 <code>int</code> 类型的变量才能成功赋值。所以这个 <code>int</code> 在属性这个包装器上并不是表达返回值的意思，仅仅是恰好写这里作为一种语法规范而已。</p>
<p>自动属性表示自动实现的属性，因为大多的 <code>get</code> 和 <code>set</code> 块里的写法都是 <code>return</code> 一个数值和 <code>this.字段 = value</code> 的赋值模式，所以干脆就在 C# 3 里添加了自动实现的属性这个特性，就不必我们手动去写这么一大堆代码了。</p>
<blockquote>
<p>前文没有讲。<code>value</code> 关键字专门用来临时代替 <code>set</code> 块生成的参数名。就好像 Java 的 <code>setxxx</code> 方法一样，它一定会带有一个参数，为指定的字段赋值，这里的 <code>set</code> 块由于不让写参数名，所以就用了一个关键字专门来表达这个东西。</p>
</blockquote>
<h2 id="自动生成的代码"><a href="#自动生成的代码" class="headerlink" title="自动生成的代码"></a>自动生成的代码</h2><p>在 C# 3 里提供了自动属性，所以自动属性可以不要求你实现 <code>get</code> 和 <code>set</code> 块，直接用分号结尾即可，甚至不让你写字段名：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它都将自动生成，生成的代码如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Age</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">this</span>.age; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; <span class="keyword">this</span>.age = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="其它用法"><a href="#其它用法" class="headerlink" title="其它用法"></a>其它用法</h2><h3 id="带访问修饰符的自动属性"><a href="#带访问修饰符的自动属性" class="headerlink" title="带访问修饰符的自动属性"></a>带访问修饰符的自动属性</h3><p>在自动属性里，它甚至提供了配套访问修饰符的模式。比如这里我们不想让 <code>age</code> 字段拥有赋值的操作，我们一般都会把 <code>set</code> 定为私有的，然后不让外界访问，只有本类里的成员可以使用 <code>Age</code> 属性的 <code>set</code> 块。</p>
<p>那么代码如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>确实很简单，只需要在前面加上 <code>private</code> 关键字即可。到时候它也会在指定的属性旁生成这个关键字，以表示 <code>set</code> 块是 <code>private</code> 的。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Class</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Age</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">this</span>.age; &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span> &#123; <span class="keyword">this</span>.age = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="初始赋值的自动属性"><a href="#初始赋值的自动属性" class="headerlink" title="初始赋值的自动属性"></a>初始赋值的自动属性</h3><p>没想到吧，C# 6 里提供了初始赋值的自动属性。由于属性在自动属性特性实现后，字段已经被编译器“隐藏起来了”，所以我们只能通过属性来给字段赋初始值。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">string</span> FirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="string">"Jane"</span>;</span><br></pre></td></tr></table></figure>
<p>生成的代码是这样的：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">string</span> FirstName = <span class="string">"Jane"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">string</span> FirstName</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">this</span>.firstName; &#125;</span><br><span class="line">    <span class="keyword">set</span> &#123; <span class="keyword">this</span>.firstName = <span class="keyword">value</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C%E2%99%AF/">C♯</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C♯/">C♯</a><a href="/tags/C♯-编译器生成/">C♯.编译器生成</a><a href="/tags/C♯-3/">C♯ 3</a><a href="/tags/C♯-6/">C♯ 6</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>




  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/3/">上一页 ↑</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/">下一页 ↓</a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="Sunnie-Shine" data-theme="medium"></div>
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>



  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/C♯/" title="C♯">C♯<sup>28</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C">C<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/LINQ/" title="LINQ">LINQ<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/位运算/" title="位运算">位运算<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/数独/" title="数独">数独<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/C♯-编译器生成/" title="C♯.编译器生成">C♯.编译器生成<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/数学/" title="数学">数学<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/SQL/" title="SQL">SQL<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/C♯-8/" title="C♯ 8">C♯ 8<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/正则表达式/" title="正则表达式">正则表达式<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/向向的每周数独/" title="向向的每周数独">向向的每周数独<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/安卓/" title="安卓">安卓<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ASP/" title="ASP">ASP<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/诗词/" title="诗词">诗词<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C♯-3/" title="C♯ 3">C♯ 3<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C♯-6/" title="C♯ 6">C♯ 6<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C♯-2/" title="C♯ 2">C♯ 2<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/TODO/" title="TODO">TODO<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://sunniesudoku.cn/" target="_blank" title="向向的数独文档库">向向的数独文档库</a>
            
          </li>
        
          <li>
            
            	<a href="http://tieba.baidu.com/f?kw=%CA%FD%B6%C0" target="_blank" title="数独贴吧">数独贴吧</a>
            
          </li>
        
          <li>
            
            	<a href="https://space.bilibili.com/23736703" target="_blank" title="Bilibili">Bilibili</a>
            
          </li>
        
    </ul>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m Sunnie. <br/>
			This is my blog.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/Sunnie-Shine" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		<a href="http://www.zhihu.com/people/Sunnie-Shine" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		
	</div>
			
		

		<p class="copyright">
		Copyright © 2020 
		
		<a href="/about" target="_blank" title="向向">向向</a>
		
		<br />
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a>
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>












<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript"
  async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
